<!--
SPDX-FileCopyrightText: Aravis Project Team

SPDX-License-Identifier: LGPL-2.1-or-later
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Aravis &ndash; 0.10: Ethernet Devices</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta charset="utf-8" />

  
  <meta property="og:type" content="website"/>

  
  <meta property="og:image:width" content="256"/>
  <meta property="og:image:height" content="256"/>
  <meta property="og:image:secure_url" content="aravis.svg"/>
  <meta property="og:image:alt" content="Aravis-0.10"/>
  

  
  <meta property="og:title" content="Aravis: Ethernet Devices"/>
  <meta property="og:description" content="Reference for Aravis-0.10: Ethernet Devices"/>
  <meta name="twitter:title" content="Aravis: Ethernet Devices"/>
  <meta name="twitter:description" content="Reference for Aravis-0.10: Ethernet Devices"/>


  
  <meta name="twitter:card" content="summary"/>

  
  
  
  <link rel="search" type="application/opensearchdescription+xml" title="Aravis" href="opensearch.xml">
  
  

  <link rel="stylesheet" href="style.css" type="text/css" />

  

  
  <script src="urlmap.js"></script>
  
  
  <script src="fzy.js"></script>
  <script src="search.js"></script>
  
  <script src="main.js"></script>

  
</head>

<body>
  <div id="body-wrapper" tabindex="-1">

    <nav class="sidebar devhelp-hidden">
      
      <div class="section">
        <img src="aravis.svg" class="logo"/>
      </div>
      
      
      <div class="search section">
        <form id="search-form" autocomplete="off">
          <input id="search-input" type="text" name="do-not-autocomplete" placeholder="Click, or press 's' to search" autocomplete="off"/>
        </form>
      </div>
      
      <div class="section namespace">
        <h3><a href="index.html">Aravis</a></h3>
        <p>API Version: 0.10</p>
        
        <p>Library Version: 0.9.0</p>
        
      </div>
      
      
      <div class="section generator">
        <p>Generated by <a href="https://gitlab.gnome.org/GNOME/gi-docgen">gi-docgen</a> 2023.4</p>
      </div>
    </nav>

    <button id="btn-to-top" class="hidden"><span class="up-arrow"></span></button>

    
<section id="main" class="content">
  
  <h4 id="title" style="display:flex;">
    Ethernet Devices
    <a href="#title" class="anchor"></a>
    
  </h4>
  
  <section>
    <div class="docblock">
    <h1 id="ethernet-device-performance">Ethernet Device Performance<a class="md-anchor" href="#ethernet-device-performance" title="Permanent link"></a></h1>
<h2 id="network-layout">Network Layout<a class="md-anchor" href="#network-layout" title="Permanent link"></a></h2>
<p>If you face a lots of lost packets, the first thing to try is to directly connect
the device to your machine, using a wired connection. If it is possible, use a
dedicated&nbsp;port.</p>
<p>Most of the cameras are able to saturate their gigabit link, so any additional
traffic may lead to packet lost. If your machine ethernet port has a lower
bandwidth than the camera, make sure the stream you are requesting will not
exceed its&nbsp;bandwidth.</p>
<h2 id="socket-buffer-size">Socket Buffer Size<a class="md-anchor" href="#socket-buffer-size" title="Permanent link"></a></h2>
<p>Under heavy <span class="caps">CPU</span> load, the input socket buffer size may be increased in order to avoid
lost packets because of a full buffer. You can try the <code>--auto</code> parameter of
<code>arv-camera-test</code>.</p>
<p>In you application, this can be tweaked using <code>g_object_set()</code> on the stream
object. For example, this code, to be called before
<a href="method.Camera.start_acquisition.html"><code>arv_camera_start_acquisition()</code></a>, will enable the auto buffer size&nbsp;mode:</p>
<div class="codehilite"><pre><span></span><code><span class="n">g_object_set</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s">&quot;socket-buffer&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ARV_GV_STREAM_SOCKET_BUFFER_AUTO</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s">&quot;socket-buffer-size&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
</code></pre></div>

<h2 id="receiving-thread-priority">Receiving Thread Priority<a class="md-anchor" href="#receiving-thread-priority" title="Permanent link"></a></h2>
<p>It is possible to increase the receiving thread priority. You can experiment
with thread priority using the <code>--realtime</code> or <code>--high-priority</code> options of
<code>arv-camera-test</code>.</p>
<p>In your code, stream thread priority can be changed in the stream buffer&nbsp;callback:</p>
<div class="codehilite"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"></span>
<span class="nf">stream_cb</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_data</span><span class="p">,</span><span class="w"> </span><span class="n">ArvStreamCallbackType</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">ArvBuffer</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ARV_STREAM_CALLBACK_TYPE_INIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">arv_make_thread_realtime</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Failed to make stream thread realtime</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>or:</p>
<div class="codehilite"><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"></span>
<span class="nf">stream_cb</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">user_data</span><span class="p">,</span><span class="w"> </span><span class="n">ArvStreamCallbackType</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">ArvBuffer</span><span class="w"> </span><span class="o">*</span><span class="n">buffer</span><span class="p">)</span><span class="w"></span>
<span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ARV_STREAM_CALLBACK_TYPE_INIT</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">arv_make_thread_high_priority</span><span class="w"> </span><span class="p">(</span><span class="mi">-10</span><span class="p">))</span><span class="w"></span>
<span class="w">            </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Failed to make stream thread high priority</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h2 id="stream-packet-size">Stream Packet Size<a class="md-anchor" href="#stream-packet-size" title="Permanent link"></a></h2>
<p>One way to increase streaming performance and lower the <span class="caps">CPU</span> use is to increase
the stream packet size. <a href="method.Camera.gv_set_packet_size.html"><code>arv_camera_gv_set_packet_size()</code></a> and
<a href="method.Camera.gv_auto_packet_size.html"><code>arv_camera_gv_auto_packet_size()</code></a> allow you to change this parameter.
By default, the network adapter of your machine will probably not let you
receive packet bigger than 1500 bytes, which is the default Maximum Transfer
Unit (<span class="caps">MTU</span>). It means if you want to use big packets, you also have to increase
the network adapter <span class="caps">MTU</span> to a greater walue (8192 bytes being a recommended
value). The exact procedure to change the <span class="caps">MTU</span> depends on the distribution you
are using. Please refer to the administrator manual of your&nbsp;distribution.</p>
<p>On Fedora, <span class="caps">MTU</span> can be changed using the network setting panel. Edit the wired
network settings. <span class="caps">MTU</span> parameter is in the Identity&nbsp;page.</p>
<p>On Debian / Ubuntu you can add a line &#8220;mtu 8192&#8221; to /etc/network/interfaces
under the correct&nbsp;device.</p>
<div class="codehilite"><pre><span></span><code>iface ethusb0 inet static
    address 192.168.45.1
    netmask 255.255.255.0
    broadcast 192.168.45.255
    mtu 8192
</code></pre></div>

<p>Please note if your device is not connected directly to the machine, you may
also have to tweak the active devices on your&nbsp;network.</p>
<h2 id="packet-socket-support">Packet Socket Support<a class="md-anchor" href="#packet-socket-support" title="Permanent link"></a></h2>
<p>Aravis can use packet sockets for the video receiving thread. But this mode
requires extended capabilities. If you want to allow your application to use
packet socket, you must set the <code>cap_net_raw</code> capability using <code>setcap</code>. For
example, the following command gives this capability to the Aravis&nbsp;viewer:</p>
<div class="codehilite"><pre><span></span><code>sudo setcap cap_net_raw+ep arv-viewer
</code></pre></div>

<h1 id="legacy-endianess-mechanism">Legacy endianess mechanism<a class="md-anchor" href="#legacy-endianess-mechanism" title="Permanent link"></a></h1>
<p>Some GigEVision devices incorrectly report a Genicam schema version greater or
equal to 1.1, while implementing the legacy behavior for register access. We
maintain a list in
<a href="https://github.com/AravisProject/aravis/blob/6f1d65608dcecef2326ae2b3a542f5f59771ea32/src/arvgcport.c#L44">arvgcport.c</a>
which allows to force the use of the legacy endianness&nbsp;mechanism.</p>
<p>The documentation about the legacy endianness mechanism is in the 3.1 appendix
(&#8216;Endianess of GigE Vision Cameras&#8217;) of the GenICam&nbsp;Standard.</p>
<p>There is a chance this part of Aravis is due to a misunderstanding of how a
GigEVision device is supposed to behave (Remember we can not use the GigEVision
specification documentation).  But until now, there was no evidence in the issue
reports it is the case. If you think this should be implemented differently,
don&#8217;t hesitate to explain your thoughts on Aravis issue report system, or even
better, to open a pull request. The related Aravis issues are available here:
<a href="https://github.com/AravisProject/aravis/labels/5.%20Genicam%201.0%20legacy%20mode">https://github.com/AravisProject/aravis/labels/5. Genicam 1.0 legacy
mode</a>.</p>
<p>Meanwhile, if you want to add a device to the exception list, please open an
issue on github, giving the vendor name and model name as found in the Genicam
data of your device, using the <code>genicam</code> command of <code>arv-tool</code>. They are stored
in the ModelName and VendorName attributes of the RegisterDescription&nbsp;element.</p>
    </div>
  </section>
</section>


    
<div id="toc" class="toc">
  <nav aria-labelledby="toc-title">
    <p id="toc-title">Content</p>
    <ul class="toc-list">
      
        
        <li class="toc-list-item"><a href="#ethernet-device-performance"><span class="link-text">Ethernet Device Performance</span></a></li>
          
          <ul class="toc-list">
          
            <li class="toc-list-item"><a href="#network-layout"><span class="link-text">Network Layout</span></a></li>
          
            <li class="toc-list-item"><a href="#socket-buffer-size"><span class="link-text">Socket Buffer Size</span></a></li>
          
            <li class="toc-list-item"><a href="#receiving-thread-priority"><span class="link-text">Receiving Thread Priority</span></a></li>
          
            <li class="toc-list-item"><a href="#stream-packet-size"><span class="link-text">Stream Packet Size</span></a></li>
          
            <li class="toc-list-item"><a href="#packet-socket-support"><span class="link-text">Packet Socket Support</span></a></li>
          
          </ul>
          
        
        <li class="toc-list-item"><a href="#legacy-endianess-mechanism"><span class="link-text">Legacy endianess mechanism</span></a></li>
          
        
      
    </ul>
  </nav>
</div>


    <section id="search" class="content hidden"></section>

    <footer>
    
    </footer>
  </div>
</body>
</html>